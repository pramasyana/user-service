package consumer

import (
	"context"
	"testing"

	localConfig "github.com/Bhinneka/user-service/config"
	mockRepoCorp "github.com/Bhinneka/user-service/src/corporate/v2/repo/mocks"
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/mock"
)

type testDataParser struct {
	name      string
	input     []byte
	wantError bool
}

const (
	// Account contact
	payloadCreateAccountContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_contact.Envelope"},"payload":{"before":null,"after":{"id":62076,"status":"ACTIVATE","is_delete":false,"is_disabled":false,"account_id":"B2BACC00000000023227","contact_id":63045,"created_at":"2021-03-28T12:07:35.187388Z","modified_at":"2021-03-28T12:07:35.187408Z","created_by":null,"modified_by":null,"is_admin":true,"department_id":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616933258357,"snapshot":"false","db":"shark-development","schema":"public","table":"account_contact","txId":204342797,"lsn":5153323248808,"xmin":null},"op":"c","ts_ms":1616933258812,"transaction":null}}`
	payloadUpdateAccountContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_contact.Envelope"},"payload":{"before":{"id":61885,"status":"","is_delete":false,"is_disabled":false,"account_id":"","contact_id":0,"created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"is_admin":false,"department_id":null},"after":{"id":61885,"status":"ACTIVATED","is_delete":false,"is_disabled":false,"account_id":"B2BACC00000000022969","contact_id":62545,"created_at":"2020-10-08T06:32:54.751972Z","modified_at":"2020-10-08T06:32:54.752014Z","created_by":null,"modified_by":null,"is_admin":true,"department_id":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616517170141,"snapshot":"false","db":"shark-development","schema":"public","table":"account_contact","txId":203719292,"lsn":5119534090528,"xmin":null},"op":"u","ts_ms":1616517170271,"transaction":null}}`
	payloadDeleteAccountContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"status"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":false,"field":"account_id"},{"type":"int32","optional":false,"field":"contact_id"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_admin"},{"type":"int32","optional":true,"field":"department_id"}],"optional":true,"name":"shark_dev.public.account_contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_contact.Envelope"},"payload":{"before":null,"after":{"id":62076,"status":"ACTIVATE","is_delete":false,"is_disabled":false,"account_id":"B2BACC00000000023227","contact_id":63045,"created_at":"2021-03-28T12:07:35.187388Z","modified_at":"2021-03-28T12:07:35.187408Z","created_by":null,"modified_by":null,"is_admin":true,"department_id":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616933258357,"snapshot":"false","db":"shark-development","schema":"public","table":"account_contact","txId":204342797,"lsn":5153323248808,"xmin":null},"op":"d","ts_ms":1616933258812,"transaction":null}}`

	// Contact
	payloadUpdateContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact.Envelope"},"payload":{"before":{"id":62607,"reference_id":null,"first_name":null,"last_name":null,"salutation":null,"job_title":null,"email":null,"nav_contact_id":null,"is_primary":null,"birth_date":null,"note":null,"created_at":"1970-01-01T00:00:00Z","modified_at":"1970-01-01T00:00:00Z","created_by":null,"modified_by":null,"account_id":null,"is_disabled":null,"password":null,"avatar":null,"status":null,"token":null,"is_new":null,"phone_number":null,"other_phone_number":null,"gender":null,"transaction_type":null},"after":{"id":62607,"reference_id":null,"first_name":"Elyse","last_name":"Predovic","salutation":"","job_title":"aYp33Kfe5","email":"bisnis007@yopmail.com","nav_contact_id":null,"is_primary":false,"birth_date":18701,"note":"","created_at":"2020-10-27T11:53:02.301303Z","modified_at":"2021-03-21T22:12:37.444052Z","created_by":null,"modified_by":62607,"account_id":null,"is_disabled":false,"password":"804fc3f4231ad8b14b009665a04a4a4a10e0a50c7837326f543f8e6120d65705:14ba3a6893434083a8813018215ae2cb","avatar":"","status":"ACTIVATED","token":"f37e14c1e7200599bfa017f2259717ff20201027115302299162","is_new":true,"phone_number":"085333277100","other_phone_number":"","gender":"male","transaction_type":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364757448,"snapshot":"false","db":"shark-development","schema":"public","table":"contact","txId":203410078,"lsn":5104384880528,"xmin":null},"op":"u","ts_ms":1616364757919,"transaction":null}}`
	payloadCreateContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact.Envelope"},"payload":{"before":null,"after":{"id":62999,"reference_id":null,"first_name":"","last_name":"","salutation":"","job_title":"","email":"91n2@yopmail.com","nav_contact_id":null,"is_primary":false,"birth_date":null,"note":"","created_at":"2021-03-21T22:07:53.24284Z","modified_at":"2021-03-21T22:07:53.24287Z","created_by":null,"modified_by":null,"account_id":null,"is_disabled":false,"password":"86666404b9e8d0c6a2a5ec872f0a499dde2c2cc1f72627834efc95e58689c70e:356270a64d3a4a0898a08062cad6bc04","avatar":"","status":"REGISTERED","token":"7ff52873dbdf58476d7536d5849c160220210321220753239732","is_new":true,"phone_number":null,"other_phone_number":null,"gender":null,"transaction_type":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364473657,"snapshot":"false","db":"shark-development","schema":"public","table":"contact","txId":203409964,"lsn":5104368036328,"xmin":null},"op":"c","ts_ms":1616364473905,"transaction":null}}`
	payloadDeleteContact = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"reference_id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"io.debezium.time.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"boolean","optional":true,"field":"is_disabled"},{"type":"string","optional":true,"field":"password"},{"type":"string","optional":true,"field":"avatar"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"token"},{"type":"boolean","optional":true,"field":"is_new"},{"type":"string","optional":true,"field":"phone_number"},{"type":"string","optional":true,"field":"other_phone_number"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"male,female"},"field":"gender"},{"type":"string","optional":true,"field":"transaction_type"}],"optional":true,"name":"shark_dev.public.contact.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact.Envelope"},"payload":{"before":null,"after":{"id":62999,"reference_id":null,"first_name":"","last_name":"","salutation":"","job_title":"","email":"91n2@yopmail.com","nav_contact_id":null,"is_primary":false,"birth_date":null,"note":"","created_at":"2021-03-21T22:07:53.24284Z","modified_at":"2021-03-21T22:07:53.24287Z","created_by":null,"modified_by":null,"account_id":null,"is_disabled":false,"password":"86666404b9e8d0c6a2a5ec872f0a499dde2c2cc1f72627834efc95e58689c70e:356270a64d3a4a0898a08062cad6bc04","avatar":"","status":"REGISTERED","token":"7ff52873dbdf58476d7536d5849c160220210321220753239732","is_new":true,"phone_number":null,"other_phone_number":null,"gender":null,"transaction_type":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364473657,"snapshot":"false","db":"shark-development","schema":"public","table":"contact","txId":203409964,"lsn":5104368036328,"xmin":null},"op":"d","ts_ms":1616364473905,"transaction":null}}`

	// Account
	payloadCreateAccount = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"before"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account.Envelope"},"payload":{"before":null,"after":{"id":"B2BACC00000000023217","parent_id":null,"nav_id":"","legal_entity":"LEMBAGA_MASYARAKAT_SWASTA","name":"Mqcgabmjm10Bd6Cfog2Mc4M046Q7C7P2Mltdc2Dq8Hbpir","industry_id":"INDUSTRI_BARANG_KONSUMSI","number_employee":"5-19","office_employee":0,"business_size":"Gold (Rp. 600jt - Rp. 1.2M)","business_group":null,"established_year":2020,"is_delete":false,"term_of_payment":"0","customer_category":null,"user_id":90,"created_at":"2021-03-21T22:07:37.790411Z","modified_at":"2021-03-21T22:07:37.790441Z","created_by":90,"modified_by":null,"accountgroup_id":null,"is_disabled":false,"status":"NEED_REVIEW","payment_method_id":"45WIPG0","payment_method_type":"TOP","sub_payment_method_name":"TOP Term 45 day","is_cf":true,"logo":"","is_parent":false,"member_type":"NON_MICROSITE"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364457846,"snapshot":"false","db":"shark-development","schema":"public","table":"account","txId":203409953,"lsn":5104367999752,"xmin":null},"op":"c","ts_ms":1616364458238,"transaction":null}}`
	payloadUpdateAccount = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"before"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account.Envelope"},"payload":{"before":null,"after":{"id":"B2BACC00000000023217","parent_id":null,"nav_id":"","legal_entity":"LEMBAGA_MASYARAKAT_SWASTA","name":"Mqcgabmjm10Bd6Cfog2Mc4M046Q7C7P2Mltdc2Dq8Hbpir","industry_id":"INDUSTRI_BARANG_KONSUMSI","number_employee":"5-19","office_employee":0,"business_size":"Gold (Rp. 600jt - Rp. 1.2M)","business_group":null,"established_year":2020,"is_delete":false,"term_of_payment":"0","customer_category":null,"user_id":90,"created_at":"2021-03-21T22:07:37.790411Z","modified_at":"2021-03-21T22:07:37.790441Z","created_by":90,"modified_by":null,"accountgroup_id":null,"is_disabled":false,"status":"NEED_REVIEW","payment_method_id":"45WIPG0","payment_method_type":"TOP","sub_payment_method_name":"TOP Term 45 day","is_cf":true,"logo":"","is_parent":false,"member_type":"NON_MICROSITE"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364457846,"snapshot":"false","db":"shark-development","schema":"public","table":"account","txId":203409953,"lsn":5104367999752,"xmin":null},"op":"u","ts_ms":1616364458238,"transaction":null}}`
	payloadDeleteAccount = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"before"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"nav_id"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":false,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":true,"field":"business_group"},{"type":"int32","optional":true,"field":"established_year"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":true,"field":"term_of_payment"},{"type":"string","optional":true,"field":"customer_category"},{"type":"int32","optional":true,"field":"user_id"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"int32","optional":true,"field":"accountgroup_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"status"},{"type":"string","optional":true,"field":"payment_method_id"},{"type":"string","optional":true,"field":"payment_method_type"},{"type":"string","optional":true,"field":"sub_payment_method_name"},{"type":"boolean","optional":false,"field":"is_cf"},{"type":"string","optional":true,"field":"logo"},{"type":"boolean","optional":true,"field":"is_parent"},{"type":"string","optional":true,"field":"member_type"}],"optional":true,"name":"shark_dev.public.account.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account.Envelope"},"payload":{"before":null,"after":{"id":"B2BACC00000000023217","parent_id":null,"nav_id":"","legal_entity":"LEMBAGA_MASYARAKAT_SWASTA","name":"Mqcgabmjm10Bd6Cfog2Mc4M046Q7C7P2Mltdc2Dq8Hbpir","industry_id":"INDUSTRI_BARANG_KONSUMSI","number_employee":"5-19","office_employee":0,"business_size":"Gold (Rp. 600jt - Rp. 1.2M)","business_group":null,"established_year":2020,"is_delete":false,"term_of_payment":"0","customer_category":null,"user_id":90,"created_at":"2021-03-21T22:07:37.790411Z","modified_at":"2021-03-21T22:07:37.790441Z","created_by":90,"modified_by":null,"accountgroup_id":null,"is_disabled":false,"status":"NEED_REVIEW","payment_method_id":"45WIPG0","payment_method_type":"TOP","sub_payment_method_name":"TOP Term 45 day","is_cf":true,"logo":"","is_parent":false,"member_type":"NON_MICROSITE"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616364457846,"snapshot":"false","db":"shark-development","schema":"public","table":"account","txId":203409953,"lsn":5104367999752,"xmin":null},"op":"d","ts_ms":1616364458238,"transaction":null}}`
	invalidPayload       = `{"schema":{"type":"struct",}}`

	// Phone
	payloadCreatePhone = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.phone.Envelope"},"payload":{"before":null,"after":{"id":75428,"relation_id":46666,"relation_type":"ADDRESS","type_phone":"MOBILE","label":"dfasa","number":"12313131","area":"","ext":"","is_primary":true,"is_delete":false,"created_at":"2021-03-25T16:52:33.734121Z","modified_at":"2021-03-25T16:52:33.734152Z","created_by":88,"modified_by":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616691154254,"snapshot":"false","db":"shark-development","schema":"public","table":"phone","txId":204073402,"lsn":5136596694872,"xmin":null},"op":"c","ts_ms":1616691154389,"transaction":null}}`
	payloadUpdatePhone = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.phone.Envelope"},"payload":{"before":{"id":75419,"relation_id":0,"relation_type":"","type_phone":"","label":"","number":"","area":null,"ext":null,"is_primary":false,"is_delete":false,"created_at":"1970-01-01T00:00:00Z","modified_at":"1970-01-01T00:00:00Z","created_by":null,"modified_by":null},"after":{"id":75419,"relation_id":62983,"relation_type":"CONTACT","type_phone":"MOBILE","label":"Home","number":"8121212","area":"","ext":"","is_primary":true,"is_delete":false,"created_at":"2021-03-16T09:37:54.119306Z","modified_at":"2021-03-17T02:16:27.647564Z","created_by":135,"modified_by":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1615947393730,"snapshot":"false","db":"shark-development","schema":"public","table":"phone","txId":202878609,"lsn":5056635303464,"xmin":null},"op":"u","ts_ms":1615947393893,"transaction":null}}`
	payloadDeletePhone = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"int32","optional":false,"field":"relation_id"},{"type":"string","optional":false,"field":"relation_type"},{"type":"string","optional":false,"field":"type_phone"},{"type":"string","optional":false,"field":"label"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":true,"field":"area"},{"type":"string","optional":true,"field":"ext"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"}],"optional":true,"name":"shark_dev.public.phone.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.phone.Envelope"},"payload":{"before":null,"after":{"id":75428,"relation_id":46666,"relation_type":"ADDRESS","type_phone":"MOBILE","label":"dfasa","number":"12313131","area":"","ext":"","is_primary":true,"is_delete":false,"created_at":"2021-03-25T16:52:33.734121Z","modified_at":"2021-03-25T16:52:33.734152Z","created_by":88,"modified_by":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616691154254,"snapshot":"false","db":"shark-development","schema":"public","table":"phone","txId":204073402,"lsn":5136596694872,"xmin":null},"op":"d","ts_ms":1616691154389,"transaction":null}}`

	//Document
	payloadUpdateDocument = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.document.Envelope"},"payload":{"before":{"id":516,"document_type":"","document_file":null,"document_title":null,"document_description":null,"npwp_number":null,"npwp_name":null,"npwp_address":null,"siup_number":null,"siup_company_name":null,"siup_type":null,"is_delete":false,"created_at":"1970-01-01T00:00:00Z","modified_at":"1970-01-01T00:00:00Z","created_by":null,"modified_by":null,"account_id":"","is_disabled":false,"province_id":null,"province_name":null,"city_id":null,"city_name":null,"district_id":null,"district_name":null,"subdistrict_id":null,"subdistrict_name":null,"postal_code":null,"street":null},"after":{"id":516,"document_type":"NPWP","document_file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/development/2021/1/21/22549.png","document_title":null,"document_description":null,"npwp_number":"777777777777777","npwp_name":"eproc development","npwp_address":null,"siup_number":null,"siup_company_name":null,"siup_type":"KECIL","is_delete":false,"created_at":"2021-01-21T03:02:45.053803Z","modified_at":"2021-03-25T04:55:26.167205Z","created_by":149,"modified_by":null,"account_id":"B2BACC00000000023144","is_disabled":false,"province_id":null,"province_name":null,"city_id":null,"city_name":null,"district_id":null,"district_name":null,"subdistrict_id":null,"subdistrict_name":null,"postal_code":null,"street":"Gn. sahari, jakarta pusat"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616648126385,"snapshot":"false","db":"shark-development","schema":"public","table":"document","txId":203968207,"lsn":5131162662928,"xmin":null},"op":"u","ts_ms":1616648126714,"transaction":null}}`
	payloadCreateDocument = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.document.Envelope"},"payload":{"before":null,"after":{"id":528,"document_type":"NPWP","document_file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/development/2021/3/25/52008.png","document_title":null,"document_description":null,"npwp_number":"524762428742864","npwp_name":"Account CF","npwp_address":null,"siup_number":null,"siup_company_name":null,"siup_type":"KECIL","is_delete":false,"created_at":"2021-03-25T03:07:42.203211Z","modified_at":"2021-03-25T03:07:42.203253Z","created_by":90,"modified_by":null,"account_id":"B2BACC00000000022864","is_disabled":false,"province_id":null,"province_name":null,"city_id":null,"city_name":null,"district_id":null,"district_name":null,"subdistrict_id":null,"subdistrict_name":null,"postal_code":null,"street":"ini adalaah alamat palsu"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616641688474,"snapshot":"false","db":"shark-development","schema":"public","table":"document","txId":203940815,"lsn":5130146484168,"xmin":null},"op":"c","ts_ms":1616641688940,"transaction":null}}`
	payloadDeleteDocument = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"document_type"},{"type":"string","optional":true,"field":"document_file"},{"type":"string","optional":true,"field":"document_title"},{"type":"string","optional":true,"field":"document_description"},{"type":"string","optional":true,"field":"npwp_number"},{"type":"string","optional":true,"field":"npwp_name"},{"type":"string","optional":true,"field":"npwp_address"},{"type":"string","optional":true,"field":"siup_number"},{"type":"string","optional":true,"field":"siup_company_name"},{"type":"string","optional":true,"field":"siup_type"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"field":"province_id"},{"type":"string","optional":true,"field":"province_name"},{"type":"string","optional":true,"field":"city_id"},{"type":"string","optional":true,"field":"city_name"},{"type":"string","optional":true,"field":"district_id"},{"type":"string","optional":true,"field":"district_name"},{"type":"string","optional":true,"field":"subdistrict_id"},{"type":"string","optional":true,"field":"subdistrict_name"},{"type":"string","optional":true,"field":"postal_code"},{"type":"string","optional":true,"field":"street"}],"optional":true,"name":"shark_dev.public.document.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.document.Envelope"},"payload":{"before":null,"after":{"id":528,"document_type":"NPWP","document_file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/development/2021/3/25/52008.png","document_title":null,"document_description":null,"npwp_number":"524762428742864","npwp_name":"Account CF","npwp_address":null,"siup_number":null,"siup_company_name":null,"siup_type":"KECIL","is_delete":false,"created_at":"2021-03-25T03:07:42.203211Z","modified_at":"2021-03-25T03:07:42.203253Z","created_by":90,"modified_by":null,"account_id":"B2BACC00000000022864","is_disabled":false,"province_id":null,"province_name":null,"city_id":null,"city_name":null,"district_id":null,"district_name":null,"subdistrict_id":null,"subdistrict_name":null,"postal_code":null,"street":"ini adalaah alamat palsu"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616641688474,"snapshot":"false","db":"shark-development","schema":"public","table":"document","txId":203940815,"lsn":5130146484168,"xmin":null},"op":"d","ts_ms":1616641688940,"transaction":null}}`

	// Address
	payloadCreateAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.address.Envelope"},"payload":{"before":null,"after":{"id":46666,"type_address":"BILLING","name":"Microsite Bpk Address 1","street":"asfasfa","province_id":"0101","province_name":"Banten","city_id":"010101","city_name":"Cilegon","district_id":"01010102","district_name":"Cilegon","subdistrict_id":"0101010201","subdistrict_name":"Bagendung","is_primary":true,"postal_code":"42419","created_at":"2021-03-25T16:52:33.694018Z","modified_at":"2021-03-25T16:52:33.694046Z","created_by":88,"modified_by":null,"account_id":"B2BACC00000000023229","is_disabled":false,"is_delete":false},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616691154254,"snapshot":"false","db":"shark-development","schema":"public","table":"address","txId":204073402,"lsn":5136596694872,"xmin":null},"op":"c","ts_ms":1616691154389,"transaction":null}}`
	payloadUpdateAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.address.Envelope"},"payload":{"before":{"id":46384,"type_address":"","name":"","street":"","province_id":"","province_name":"","city_id":"","city_name":"","district_id":"","district_name":"","subdistrict_id":"","subdistrict_name":"","is_primary":false,"postal_code":"","created_at":"1970-01-01T00:00:00Z","modified_at":"1970-01-01T00:00:00Z","created_by":null,"modified_by":null,"account_id":"","is_disabled":false,"is_delete":false},"after":{"id":46384,"type_address":"SHIPPING","name":"Billing Address 1","street":"jalan aja","province_id":"0103","province_name":"DKI Jakarta","city_id":"010302","city_name":"Jakarta Pusat","district_id":"01030201","district_name":"Cempaka Putih","subdistrict_id":"0103020101","subdistrict_name":"Cempaka Putih Barat","is_primary":true,"postal_code":"10520","created_at":"2019-02-21T06:33:57.787839Z","modified_at":"2019-02-21T06:33:57.787868Z","created_by":0,"modified_by":null,"account_id":"B2BACC00000000022800","is_disabled":false,"is_delete":false},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616158541373,"snapshot":"false","db":"shark-development","schema":"public","table":"address","txId":203275960,"lsn":5092187047752,"xmin":null},"op":"u","ts_ms":1616158541369,"transaction":null}}`
	payloadDeleteAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"type_address"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_primary"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":false,"field":"account_id"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"boolean","optional":false,"field":"is_delete"}],"optional":true,"name":"shark_dev.public.address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.address.Envelope"},"payload":{"before":null,"after":{"id":46666,"type_address":"BILLING","name":"Microsite Bpk Address 1","street":"asfasfa","province_id":"0101","province_name":"Banten","city_id":"010101","city_name":"Cilegon","district_id":"01010102","district_name":"Cilegon","subdistrict_id":"0101010201","subdistrict_name":"Bagendung","is_primary":true,"postal_code":"42419","created_at":"2021-03-25T16:52:33.694018Z","modified_at":"2021-03-25T16:52:33.694046Z","created_by":88,"modified_by":null,"account_id":"B2BACC00000000023229","is_disabled":false,"is_delete":false},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616691154254,"snapshot":"false","db":"shark-development","schema":"public","table":"address","txId":204073402,"lsn":5136596694872,"xmin":null},"op":"d","ts_ms":1616691154389,"transaction":null}}`

	// Contact Address
	payloadCreateContactAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"before"},{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_address.Envelope"},"payload":{"before":null,"after":{"id":403,"name":"56S1Dv0Q603qhHojtmCxM8Bcv8GwwZo3onR3V0MVoEpqzX1S0","pic_name":"uBQqlX60yU3bCcuMU54W8JjlpKexNXk2sBPp9bapbfR0R","phone":"085609370431","street":"hxPmnE2tw0IDlRybN2T6EvDksVxkX1JeA8H3WfSn76b8dR2BEwLSR14WTsu296nS3cccT1Wm2DfMhXc0XNK9gc5hu9T8HlJA5NQdy174qH50MXGKlOhIILT8917tu550BRR2KRwmUwaDn6vByBwIDg00BE730J5q6kMQz3tzofaqxD1F3r3uo86zF560YJ4vhN06Jg7kplPZSDu6L1c9Su6MR5gGhO63QKwDJE5t0KpVNRXoWgK1094OcZoK5Rmkv2VCvR11BHhvvjYQVLa396QEhYjKt3PWOegRlHnHq3","province_id":"0102","province_name":"DI Yogyakarta","city_id":"010201","city_name":"Bantul","district_id":"01020109","district_name":"Pajangan","subdistrict_id":"0102010903","subdistrict_name":"Triwidadi","is_billing":false,"is_shipping":false,"postal_code":"55751","created_at":"2021-03-28T18:13:00.688228Z","modified_at":"2021-03-28T18:13:00.688262Z","created_by":null,"modified_by":null,"is_delete":false,"contact_id":62607},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616955180694,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_address","txId":204375197,"lsn":5154750167864,"xmin":null},"op":"c","ts_ms":1616955180853,"transaction":null}}`
	payloadUpdateContactAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"before"},{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_address.Envelope"},"payload":{"before":{"id":347,"name":"","pic_name":"","phone":"","street":"","province_id":"","province_name":"","city_id":"","city_name":"","district_id":"","district_name":"","subdistrict_id":"","subdistrict_name":"","is_billing":false,"is_shipping":false,"postal_code":"","created_at":"1970-01-01T00:00:00Z","modified_at":"1970-01-01T00:00:00Z","created_by":null,"modified_by":null,"is_delete":false,"contact_id":0},"after":{"id":347,"name":"Office","pic_name":"Linnn","phone":"098789","street":"gunung sahari","province_id":"0103","province_name":"DKI Jakarta","city_id":"010302","city_name":"Jakarta Pusat","district_id":"01030201","district_name":"Cempaka Putih","subdistrict_id":"0103020102","subdistrict_name":"Cempaka Putih Timur","is_billing":true,"is_shipping":false,"postal_code":"10510","created_at":"2021-03-02T04:31:56.76881Z","modified_at":"2021-03-26T15:31:47.366295Z","created_by":null,"modified_by":null,"is_delete":false,"contact_id":62852},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616772707370,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_address","txId":204235456,"lsn":5143592435752,"xmin":null},"op":"u","ts_ms":1616772707819,"transaction":null}}`
	payloadDeleteContactAddress = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"before"},{"type":"struct","fields":[{"type":"int64","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"pic_name"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"street"},{"type":"string","optional":false,"field":"province_id"},{"type":"string","optional":false,"field":"province_name"},{"type":"string","optional":false,"field":"city_id"},{"type":"string","optional":false,"field":"city_name"},{"type":"string","optional":false,"field":"district_id"},{"type":"string","optional":false,"field":"district_name"},{"type":"string","optional":false,"field":"subdistrict_id"},{"type":"string","optional":false,"field":"subdistrict_name"},{"type":"boolean","optional":false,"field":"is_billing"},{"type":"boolean","optional":false,"field":"is_shipping"},{"type":"string","optional":false,"field":"postal_code"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"int32","optional":false,"field":"contact_id"}],"optional":true,"name":"shark_dev.public.contact_address.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_address.Envelope"},"payload":{"before":null,"after":{"id":403,"name":"56S1Dv0Q603qhHojtmCxM8Bcv8GwwZo3onR3V0MVoEpqzX1S0","pic_name":"uBQqlX60yU3bCcuMU54W8JjlpKexNXk2sBPp9bapbfR0R","phone":"085609370431","street":"hxPmnE2tw0IDlRybN2T6EvDksVxkX1JeA8H3WfSn76b8dR2BEwLSR14WTsu296nS3cccT1Wm2DfMhXc0XNK9gc5hu9T8HlJA5NQdy174qH50MXGKlOhIILT8917tu550BRR2KRwmUwaDn6vByBwIDg00BE730J5q6kMQz3tzofaqxD1F3r3uo86zF560YJ4vhN06Jg7kplPZSDu6L1c9Su6MR5gGhO63QKwDJE5t0KpVNRXoWgK1094OcZoK5Rmkv2VCvR11BHhvvjYQVLa396QEhYjKt3PWOegRlHnHq3","province_id":"0102","province_name":"DI Yogyakarta","city_id":"010201","city_name":"Bantul","district_id":"01020109","district_name":"Pajangan","subdistrict_id":"0102010903","subdistrict_name":"Triwidadi","is_billing":false,"is_shipping":false,"postal_code":"55751","created_at":"2021-03-28T18:13:00.688228Z","modified_at":"2021-03-28T18:13:00.688262Z","created_by":null,"modified_by":null,"is_delete":false,"contact_id":62607},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616955180694,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_address","txId":204375197,"lsn":5154750167864,"xmin":null},"op":"d","ts_ms":1616955180853,"transaction":null}}`

	//Leads
	payloadCreateLeads = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.leads.Envelope"},"payload":{"before":null,"after":{"id":807,"name":"yaya raisa","email":"microsite@getnada.com","phone":"081819281","source_id":"QT210329114849WHP","source":"QUOTATION","source_status":"ASK_QUOTATION","status":"OPEN","notes":"","created_at":"2021-03-29T04:51:02.970681Z","modified_at":"2021-03-29T04:51:02.970777Z","created_by":null,"modified_by":null,"is_need_tax":false,"transaction_source":"corporate"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616993462980,"snapshot":"false","db":"shark-development","schema":"public","table":"leads","txId":204421520,"lsn":5157876053064,"xmin":null},"op":"c","ts_ms":1616993463242,"transaction":null}}`
	payloadUpdateLeads = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.leads.Envelope"},"payload":{"before":null,"after":{"id":807,"name":"yaya raisa","email":"microsite@getnada.com","phone":"081819281","source_id":"QT210329114849WHP","source":"QUOTATION","source_status":"ASK_QUOTATION","status":"OPEN","notes":"","created_at":"2021-03-29T04:51:02.970681Z","modified_at":"2021-03-29T04:51:02.970777Z","created_by":null,"modified_by":null,"is_need_tax":false,"transaction_source":"corporate"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616993462980,"snapshot":"false","db":"shark-development","schema":"public","table":"leads","txId":204421520,"lsn":5157876053064,"xmin":null},"op":"u","ts_ms":1616993463242,"transaction":null}}`
	payloadDeleteLeads = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"phone"},{"type":"string","optional":false,"field":"source_id"},{"type":"string","optional":false,"field":"source"},{"type":"string","optional":false,"field":"source_status"},{"type":"string","optional":false,"field":"status"},{"type":"string","optional":false,"field":"notes"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":false,"field":"is_need_tax"},{"type":"string","optional":true,"field":"transaction_source"}],"optional":true,"name":"shark_dev.public.leads.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.leads.Envelope"},"payload":{"before":null,"after":{"id":807,"name":"yaya raisa","email":"microsite@getnada.com","phone":"081819281","source_id":"QT210329114849WHP","source":"QUOTATION","source_status":"ASK_QUOTATION","status":"OPEN","notes":"","created_at":"2021-03-29T04:51:02.970681Z","modified_at":"2021-03-29T04:51:02.970777Z","created_by":null,"modified_by":null,"is_need_tax":false,"transaction_source":"corporate"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616993462980,"snapshot":"false","db":"shark-development","schema":"public","table":"leads","txId":204421520,"lsn":5157876053064,"xmin":null},"op":"d","ts_ms":1616993463242,"transaction":null}}`

	// Contact NPWP
	payloadCreateContactNPWP = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_prod.public.contact_npwp.Envelope"},"payload":{"before":null,"after":{"id":407,"number":"592001796622000","name":"CV EKA CAHYA","address":"Cilongkrang, Kec Wanareja, Kab Cilacap, Jateng","address2":"Cilongkrang, Kec Wanareja, Kab Cilacap, Jateng","contact_id":78314,"file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/2021/3/27/46379.jpeg","created_at":"2021-03-26T23:57:39.566208Z","modified_at":"2021-03-26T23:57:39.566235Z","created_by":null,"modified_by":null,"is_delete":false},"source":{"version":"1.4.0.Final","connector":"postgresql","name":"shark-prod","ts_ms":1616803059650,"snapshot":"false","db":"shark_prod","schema":"public","table":"contact_npwp","txId":65952411,"lsn":5960810755824,"xmin":null},"op":"c","ts_ms":1616803060109,"transaction":null}}`
	payloadUpdateContactNPWP = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_prod.public.contact_npwp.Envelope"},"payload":{"before":{"id":402,"number":"","name":"","address":"","address2":null,"contact_id":null,"file":null,"created_at":"1970-01-01T00:00:00Z","modified_at":null,"created_by":null,"modified_by":null,"is_delete":null},"after":{"id":402,"number":"000031146707000","name":"SEKOLAH MENENGAH KEJURUAN SMTI PONTIANAK","address":"Jl. Sulawesi Dalam. No.31 Pontianak, Kalimantan Barat, Pontianak, Pontianak Selatan, Akcaya, 78121","address2":"Jl. Sulawesi Dalam. No.31 Pontianak, Kalimantan Barat, Pontianak, Pontianak Selatan, Akcaya, 78121","contact_id":78229,"file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/2021/3/23/41205.jpeg","created_at":"2021-03-23T07:33:57.165151Z","modified_at":"2021-03-23T08:08:01.508491Z","created_by":null,"modified_by":null,"is_delete":false},"source":{"version":"1.4.0.Final","connector":"postgresql","name":"shark-prod","ts_ms":1616486881689,"snapshot":"false","db":"shark_prod","schema":"public","table":"contact_npwp","txId":65448133,"lsn":5943077245096,"xmin":null},"op":"u","ts_ms":1616486881910,"transaction":null}}`
	payloadDeleteContactNPWP = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"number"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"address"},{"type":"string","optional":true,"field":"address2"},{"type":"int32","optional":true,"field":"contact_id"},{"type":"string","optional":true,"field":"file"},{"type":"string","optional":false,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"boolean","optional":true,"field":"is_delete"}],"optional":true,"name":"shark_prod.public.contact_npwp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_prod.public.contact_npwp.Envelope"},"payload":{"before":null,"after":{"id":407,"number":"592001796622000","name":"CV EKA CAHYA","address":"Cilongkrang, Kec Wanareja, Kab Cilacap, Jateng","address2":"Cilongkrang, Kec Wanareja, Kab Cilacap, Jateng","contact_id":78314,"file":"https://bmd-upload.s3.ap-southeast-1.amazonaws.com/sk/2021/3/27/46379.jpeg","created_at":"2021-03-26T23:57:39.566208Z","modified_at":"2021-03-26T23:57:39.566235Z","created_by":null,"modified_by":null,"is_delete":false},"source":{"version":"1.4.0.Final","connector":"postgresql","name":"shark-prod","ts_ms":1616803059650,"snapshot":"false","db":"shark_prod","schema":"public","table":"contact_npwp","txId":65952411,"lsn":5960810755824,"xmin":null},"op":"d","ts_ms":1616803060109,"transaction":null}}`

	payloadCreateAccountTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_temporary.Envelope"},"payload":{"before":null,"after":{"id":785,"industry_id":"KEUANGAN","number_employee":"","office_employee":0,"business_size":"","organization_name":"Company AAA","legal_entity":"PT_SWASTA","name":"","salutation":"","email":"personalaa@getnada.com","password":"","token":"3debd22f74dbad5d4a2f026140de3fda20210319075332595841","is_delete":false,"is_disabled":false,"phone":"{}","parent_id":"B2BACC00000000022993","npwp_number":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616140413048,"snapshot":"false","db":"shark-development","schema":"public","table":"account_temporary","txId":203208804,"lsn":5089222200064,"xmin":null},"op":"c","ts_ms":1616140413335,"transaction":null}}`
	payloadUpdateAccountTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_temporary.Envelope"},"payload":{"before":null,"after":{"id":785,"industry_id":"KEUANGAN","number_employee":"","office_employee":0,"business_size":"","organization_name":"Company AAA","legal_entity":"PT_SWASTA","name":"","salutation":"","email":"personalaa@getnada.com","password":"","token":"3debd22f74dbad5d4a2f026140de3fda20210319075332595841","is_delete":false,"is_disabled":false,"phone":"{}","parent_id":"B2BACC00000000022993","npwp_number":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616140413048,"snapshot":"false","db":"shark-development","schema":"public","table":"account_temporary","txId":203208804,"lsn":5089222200064,"xmin":null},"op":"u","ts_ms":1616140413335,"transaction":null}}`
	payloadDeleteAccountTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":false,"field":"industry_id"},{"type":"string","optional":false,"field":"number_employee"},{"type":"int32","optional":true,"field":"office_employee"},{"type":"string","optional":false,"field":"business_size"},{"type":"string","optional":false,"field":"organization_name"},{"type":"string","optional":false,"field":"legal_entity"},{"type":"string","optional":false,"field":"name"},{"type":"string","optional":false,"field":"salutation"},{"type":"string","optional":false,"field":"email"},{"type":"string","optional":false,"field":"password"},{"type":"string","optional":false,"field":"token"},{"type":"boolean","optional":false,"field":"is_delete"},{"type":"boolean","optional":false,"field":"is_disabled"},{"type":"string","optional":true,"name":"io.debezium.data.Json","version":1,"field":"phone"},{"type":"string","optional":true,"field":"parent_id"},{"type":"string","optional":true,"field":"npwp_number"}],"optional":true,"name":"shark_dev.public.account_temporary.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.account_temporary.Envelope"},"payload":{"before":null,"after":{"id":785,"industry_id":"KEUANGAN","number_employee":"","office_employee":0,"business_size":"","organization_name":"Company AAA","legal_entity":"PT_SWASTA","name":"","salutation":"","email":"personalaa@getnada.com","password":"","token":"3debd22f74dbad5d4a2f026140de3fda20210319075332595841","is_delete":false,"is_disabled":false,"phone":"{}","parent_id":"B2BACC00000000022993","npwp_number":null},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1616140413048,"snapshot":"false","db":"shark-development","schema":"public","table":"account_temporary","txId":203208804,"lsn":5089222200064,"xmin":null},"op":"d","ts_ms":1616140413335,"transaction":null}}`

	payloadUpdateContactTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_temp.Envelope"},"payload":{"before":{"id":52919,"first_name":null,"last_name":null,"salutation":null,"job_title":null,"email":null,"nav_contact_id":null,"is_primary":null,"birth_date":null,"note":null,"created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":null,"reference_id":null},"after":{"id":52919,"first_name":"Siswo","last_name":"Kuncoro","salutation":"MR","job_title":"NoTitle","email":"me@mail.com","nav_contact_id":"","is_primary":false,"birth_date":null,"note":"","created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":"9/0916/00000052","reference_id":"CTSF/0000001739"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1617074440235,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_temp","txId":204598596,"lsn":5177558221528,"xmin":null},"op":"c","ts_ms":1617074440646,"transaction":null}}`
	payloadCreateContactTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_temp.Envelope"},"payload":{"before":{"id":52919,"first_name":null,"last_name":null,"salutation":null,"job_title":null,"email":null,"nav_contact_id":null,"is_primary":null,"birth_date":null,"note":null,"created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":null,"reference_id":null},"after":{"id":52919,"first_name":"Siswo","last_name":"Kuncoro","salutation":"MR","job_title":"NoTitle","email":"me@mail.com","nav_contact_id":"","is_primary":false,"birth_date":null,"note":"","created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":"9/0916/00000052","reference_id":"CTSF/0000001739"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1617074440235,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_temp","txId":204598596,"lsn":5177558221528,"xmin":null},"op":"u","ts_ms":1617074440646,"transaction":null}}`
	payloadDeleteContactTemp = `{"schema":{"type":"struct","fields":[{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"before"},{"type":"struct","fields":[{"type":"int32","optional":false,"field":"id"},{"type":"string","optional":true,"field":"first_name"},{"type":"string","optional":true,"field":"last_name"},{"type":"string","optional":true,"field":"salutation"},{"type":"string","optional":true,"field":"job_title"},{"type":"string","optional":true,"field":"email"},{"type":"string","optional":true,"field":"nav_contact_id"},{"type":"boolean","optional":true,"field":"is_primary"},{"type":"int32","optional":true,"name":"org.apache.kafka.connect.data.Date","version":1,"field":"birth_date"},{"type":"string","optional":true,"field":"note"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"created_at"},{"type":"string","optional":true,"name":"io.debezium.time.ZonedTimestamp","version":1,"field":"modified_at"},{"type":"int32","optional":true,"field":"created_by"},{"type":"int32","optional":true,"field":"modified_by"},{"type":"string","optional":true,"field":"account_id"},{"type":"string","optional":true,"field":"reference_id"}],"optional":true,"name":"shark_dev.public.contact_temp.Value","field":"after"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"version"},{"type":"string","optional":false,"field":"connector"},{"type":"string","optional":false,"field":"name"},{"type":"int64","optional":false,"field":"ts_ms"},{"type":"string","optional":true,"name":"io.debezium.data.Enum","version":1,"parameters":{"allowed":"true,last,false"},"default":"false","field":"snapshot"},{"type":"string","optional":false,"field":"db"},{"type":"string","optional":false,"field":"schema"},{"type":"string","optional":false,"field":"table"},{"type":"int64","optional":true,"field":"txId"},{"type":"int64","optional":true,"field":"lsn"},{"type":"int64","optional":true,"field":"xmin"}],"optional":false,"name":"io.debezium.connector.postgresql.Source","field":"source"},{"type":"string","optional":false,"field":"op"},{"type":"int64","optional":true,"field":"ts_ms"},{"type":"struct","fields":[{"type":"string","optional":false,"field":"id"},{"type":"int64","optional":false,"field":"total_order"},{"type":"int64","optional":false,"field":"data_collection_order"}],"optional":true,"field":"transaction"}],"optional":false,"name":"shark_dev.public.contact_temp.Envelope"},"payload":{"before":{"id":52919,"first_name":null,"last_name":null,"salutation":null,"job_title":null,"email":null,"nav_contact_id":null,"is_primary":null,"birth_date":null,"note":null,"created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":null,"reference_id":null},"after":{"id":52919,"first_name":"Siswo","last_name":"Kuncoro","salutation":"MR","job_title":"NoTitle","email":"me@mail.com","nav_contact_id":"","is_primary":false,"birth_date":null,"note":"","created_at":null,"modified_at":null,"created_by":null,"modified_by":null,"account_id":"9/0916/00000052","reference_id":"CTSF/0000001739"},"source":{"version":"1.3.1.Final","connector":"postgresql","name":"shark-dev","ts_ms":1617074440235,"snapshot":"false","db":"shark-development","schema":"public","table":"contact_temp","txId":204598596,"lsn":5177558221528,"xmin":null},"op":"d","ts_ms":1617074440646,"transaction":null}}`

	//
)

func TestParserContact(t *testing.T) {
	mockCorp := new(mockRepoCorp.ContactRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateContactRepository: mockCorp,
	}
	var contactTestData = []testDataParser{
		{
			name:      "UpdateContact",
			input:     []byte(payloadUpdateContact),
			wantError: false,
		},
		{
			name:      "CreateContact",
			input:     []byte(payloadCreateContact),
			wantError: false,
		},
		{
			name:      "DeleteContact",
			input:     []byte(payloadDeleteContact),
			wantError: false,
		},
		{
			name:      "FailedParseContact",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range contactTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkContact(context.Background(), serviceRepo, "processSharkContact", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseAccount(t *testing.T) {
	mockCorp := new(mockRepoCorp.AccountRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateAccountRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateAccount",
			input:     []byte(payloadCreateAccount),
			wantError: false,
		},
		{
			name:      "UpdateAccount",
			input:     []byte(payloadUpdateAccount),
			wantError: false,
		},
		{
			name:      "DeleteAccount",
			input:     []byte(payloadDeleteAccount),
			wantError: false,
		},
		{
			name:      "FailedParseAccount",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkAccount(context.Background(), serviceRepo, "processSharkAccount", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseAccountContact(t *testing.T) {
	mockCorp := new(mockRepoCorp.AccountContactRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateAccountContactRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateAccountContact",
			input:     []byte(payloadCreateAccountContact),
			wantError: false,
		},
		{
			name:      "UpdateAccountContact",
			input:     []byte(payloadUpdateAccountContact),
			wantError: false,
		},
		{
			name:      "DeleteAccountContact",
			input:     []byte(payloadDeleteAccountContact),
			wantError: false,
		},
		{
			name:      "FailedParseAccountContactContact",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkAccountContact(context.Background(), serviceRepo, "processSharkAccountContact", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParsePhone(t *testing.T) {
	mockCorp := new(mockRepoCorp.PhoneRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporatePhoneRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreatePhone",
			input:     []byte(payloadCreatePhone),
			wantError: false,
		},
		{
			name:      "UpdatePhone",
			input:     []byte(payloadUpdatePhone),
			wantError: false,
		},
		{
			name:      "DeletePhone",
			input:     []byte(payloadDeletePhone),
			wantError: false,
		},
		{
			name:      "FailedParsePhone",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkPhone(context.Background(), serviceRepo, "processSharkAccountContact", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseDocument(t *testing.T) {
	mockCorp := new(mockRepoCorp.DocumentRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateDocumentRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateDocument",
			input:     []byte(payloadCreateDocument),
			wantError: false,
		},
		{
			name:      "UpdateDocument",
			input:     []byte(payloadUpdateDocument),
			wantError: false,
		},
		{
			name:      "DeleteDocument",
			input:     []byte(payloadDeleteDocument),
			wantError: false,
		},
		{
			name:      "FailedParseDocument",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkDocument(context.Background(), serviceRepo, "processSharkDocument", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseAddress(t *testing.T) {
	mockCorp := new(mockRepoCorp.AddressRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateAddressRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateAddress",
			input:     []byte(payloadCreateAddress),
			wantError: false,
		},
		{
			name:      "UpdateAddress",
			input:     []byte(payloadUpdateAddress),
			wantError: false,
		},
		{
			name:      "DeleteAddress",
			input:     []byte(payloadDeleteAddress),
			wantError: false,
		},
		{
			name:      "FailedParseAddress",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkAddress(context.Background(), serviceRepo, "processSharkAddress", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseContactAddress(t *testing.T) {
	mockCorp := new(mockRepoCorp.ContactAddressRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateContactAddressRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateContactAddress",
			input:     []byte(payloadCreateContactAddress),
			wantError: false,
		},
		{
			name:      "CreateContactAddress",
			input:     []byte(payloadUpdateContactAddress),
			wantError: false,
		},
		{
			name:      "CreateContactAddress",
			input:     []byte(payloadDeleteContactAddress),
			wantError: false,
		},
		{
			name:      "FailedParseContactAddress",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkContactAddress(context.Background(), serviceRepo, "processSharkContactAddress", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseLeads(t *testing.T) {
	mockCorp := new(mockRepoCorp.LeadsRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateLeadsRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateLeads",
			input:     []byte(payloadCreateLeads),
			wantError: false,
		},
		{
			name:      "CreateLeads",
			input:     []byte(payloadUpdateLeads),
			wantError: false,
		},
		{
			name:      "CreateLeads",
			input:     []byte(payloadDeleteLeads),
			wantError: false,
		},
		{
			name:      "FailedParseLeads",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkLeads(context.Background(), serviceRepo, "processSharkLeads", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseContactNPWP(t *testing.T) {
	mockCorp := new(mockRepoCorp.ContactNpwpRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateContactNPWPRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateContactNPWP",
			input:     []byte(payloadCreateContactNPWP),
			wantError: false,
		},
		{
			name:      "CreateContactNPWP",
			input:     []byte(payloadUpdateContactNPWP),
			wantError: false,
		},
		{
			name:      "CreateContactNPWP",
			input:     []byte(payloadDeleteContactNPWP),
			wantError: false,
		},
		{
			name:      "FailedParseContactNPWP",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkContactNPWP(context.Background(), serviceRepo, "processSharkContactNPWP", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseAccountTemp(t *testing.T) {
	mockCorp := new(mockRepoCorp.AccountTemporaryRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateAccountTempRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateAccountTemp",
			input:     []byte(payloadCreateAccountTemp),
			wantError: false,
		},
		{
			name:      "CreateAccountTemp",
			input:     []byte(payloadUpdateAccountTemp),
			wantError: false,
		},
		{
			name:      "CreateAccountTemp",
			input:     []byte(payloadDeleteAccountTemp),
			wantError: false,
		},
		{
			name:      "FailedParseAccountTemp",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkAccountTemp(context.Background(), serviceRepo, "processSharkAccountTemp", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}

func TestParseContactTemp(t *testing.T) {
	mockCorp := new(mockRepoCorp.ContactTempRepository)
	serviceRepo := localConfig.ServiceRepository{
		CorporateContactTempRepository: mockCorp,
	}
	var accountTestData = []testDataParser{
		{
			name:      "CreateContactTemp",
			input:     []byte(payloadCreateContactTemp),
			wantError: false,
		},
		{
			name:      "CreateContactTemp",
			input:     []byte(payloadUpdateContactTemp),
			wantError: false,
		},
		{
			name:      "CreateContactTemp",
			input:     []byte(payloadDeleteContactTemp),
			wantError: false,
		},
		{
			name:      "FailedParseContactTemp",
			input:     []byte(invalidPayload),
			wantError: true,
		},
	}
	for _, tc := range accountTestData {
		mockCorp.On("Update", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Save", mock.Anything, mock.Anything).Return(nil)
		mockCorp.On("Delete", mock.Anything, mock.Anything).Return(nil)
		err := ProcessSharkContactTemp(context.Background(), serviceRepo, "processSharkAccountTemp", tc.input)
		if tc.wantError {
			assert.Error(t, err)
		} else {
			assert.NoError(t, err)
		}
	}
}
